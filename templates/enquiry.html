<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enquiry</title>
    {% include 'common/mylinks.html' %}

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <style>
        
        .enquiry-card {
            background-color: transparent;
            border: none;
        }
        .section-title {
            font-weight: 600;
            color: #d9534f;
        }
        .map-container {
            overflow: hidden;
            border-radius: 50px 0px 50px 0px;
            width: 100%;
            height: 100%;
        }
        .err {
            color: #d9534f;
            display: block;
            font-size: 0.875em;
            margin-top: 0.25rem;
        }
        .captcha-group .input-group-text {
            padding: 0;
            border: 1px solid #ced4da;
        }
        #imgcaptcha {
            border-top-left-radius: 0.375rem;
            border-bottom-left-radius: 0.375rem;
        }
        #refreshcode {
            cursor: pointer;
            padding: 0.75rem;
            transition: transform 0.3s ease;
        }
        #refreshcode:hover {
            transform: rotate(180deg);
        }
    </style>
</head>
<body class="pt-0">
    <div class="container-fluid p-0">
        {% include 'common/header.html' %}

        <div class="container my-5">
            <h1 class="text-center section-title mb-4">Enquiry Form</h1>
            <div class="row gy-4">

                <div class="col-lg-7">
                    <div class="card p-4 p-md-5 enquiry-card">
                        <form action="/submit_enquery" method="post" id="enquiryForm">
                            <div class="form-floating mb-3">
                                <input type="text" name="enname" class="form-control" id="ename" placeholder="Enter Your Full Name" pattern="^[A-Za-z\s]+$" title="Only letters and white spaces (2-50 characters)">
                                <label for="ename">Enter Your Full Name</label>
                            </div>
                            <div class="form-floating mb-3">
                                <input type="email" name="enemail" class="form-control" id="eemail" placeholder="name@example.com">
                                <label for="eemail">Email address</label>
                            </div>
                            <div class="form-floating mb-3">
                                <input type="number" name="enmobile" class="form-control" id="emobile" placeholder="Enter Your Mobile Number">
                                <label for="emobile">Enter Mobile Number</label>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <select class="form-select" id="estate" name="enstate" aria-label="State select">
                                            <option selected disabled>Choose Your State</option>
                                        </select>
                                        <label for="estate">State</label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <select class="form-select" id="ecity" name="encity" aria-label="City select">
                                            <option selected disabled>Choose Your City</option>
                                        </select>
                                        <label for="ecity">City</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-floating mb-3">
                                <select class="form-select" id="ecourse" name="encourse" aria-label="Course select">
                                    <option selected disabled>Choose Your Course</option>
                                    <option value="BA (Mass Comm.)">BA (Mass Comm.)</option>
                                    <option value="BBA">BBA</option>
                                    <option value="BCA">BCA</option>
                                    <option value="BCOM(H)">BCOM(H)</option>
                                    <option value="MBA">MBA</option>
                                    <option value="MCA">MCA</option>
                                    <option value="MCOM">MCOM</option>
                                </select>
                                <label for="ecourse">Course</label>
                            </div>
                            <div class="input-group mb-3 captcha-group">
                                <span class="input-group-text">
                                    <img src="/static/captcha_file/{{captcha_img_name}}" alt="Captcha" id="imgcaptcha" height="40">
                                </span>
                                <span class="input-group-text bg-light">
                                    <i class="fa-solid fa-arrows-rotate text-primary" id="refreshcode" title="Refresh Code"></i>
                                </span>
                                <input type="text" name="encaptcha" class="form-control" id="ecaptcha" placeholder="Type Captcha">
                            </div>
                            <div class="d-grid gap-2">
                                <button class="btn btn-primary btn-lg" id="ebtnsave" type="submit">Submit</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="col-lg-5 d-flex flex-column ">
                    <div class="shadow-lg map-container flex-grow-1">
                        <iframe class="map-container" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3608.243547222048!2d82.99955231501097!3d25.26233298386561!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x398e31005b867c4f%3A0x6f6a4478e58e62d6!2sSchool%20of%20Management%20Sciences%20(SMS)%2C%20Varanasi!5e0!3m2!1sen!2sin!4v1663168181585!5m2!1sen!2sin" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>
            </div>
        </div>
        
        {% if msg %}
        <script>
            alert("{{ msg }}");
            window.location.href = "{{url_for('index')}}"; 
        </script>
        {% endif %}

        {% include 'common/footer.html' %}
    </div>
    <script>
    $(document).ready(function() {
        // --- CAPTCHA REFRESH ---
        $("#refreshcode").click(function() {
            $.get("getnew_captcha", null, function(data) {
                $('#imgcaptcha').attr("src", "/static/captcha_file/" + data)
            });
        });

        // --- FORM VALIDATION ---
        $('#enquiryForm').submit(function(event) {
            let status = true;
            $('.err').remove();
            const ename = $('#ename').val().trim();
            if (ename.length === 0) {
                $("#ename").after("<span class='err'>Please enter your name.</span>");
                status = false;
            }
            const eemail = $('#eemail').val().trim();
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (eemail.length === 0) {
                $("#eemail").after("<span class='err'>Please enter your email.</span>");
                status = false;
            } else if (!emailPattern.test(eemail)) {
                $("#eemail").after("<span class='err'>Please enter a valid email.</span>");
                status = false;
            }
            const emobile = $('#emobile').val().trim();
            if (emobile.length !== 10 || !/^[6-9]/.test(emobile)) {
                 $("#emobile").after("<span class='err'>Please enter a valid 10-digit mobile number.</span>");
                status = false;
            }
            if ($('#estate').val() === null) {
                $("#estate").after("<span class='err'>Please select your state.</span>");
                status = false;
            }
            if ($('#ecity').val() === null) {
                $("#ecity").after("<span class='err'>Please select your city.</span>");
                status = false;
            }
            if ($('#ecourse').val() === null) {
                $("#ecourse").after("<span class='err'>Please select your course.</span>");
                status = false;
            }
            if ($('#ecaptcha').val().trim().length === 0) {
                $("#ecaptcha").closest('.input-group').after("<span class='err'>Please enter the captcha.</span>");
                status = false;
            }
            if (!status) {
                event.preventDefault();
            }
            return status;
        });

        // --- STATE AND CITY DROPDOWNS ---
        const statesAndCities = {
            "Andaman and Nicobar Islands": ["Adilabad", "Diglipur",  "Mayabunder", "Nicobar", "North Andaman","Port Blair", "South Andaman", "Tanuku", "Yanam"],
            "Andhra Pradesh": ["Guntur", "Kurnool", "Nellore", "Srikakulam","Visakhapatnam", "Vijayawada"],
            "Arunachal Pradesh": ["Itanagar", "Naharlagun", "Pasighat", "Sivasagar", "Tawang"],
            "Assam": ["Dibrugarh","Guwahati", "Jorhat", "Nagaon", "Silchar", "Tezpur", "Tinsukia"],
            "Bihar": [ "Bhagalpur","Bhojpur","Buxar","Darbhanga","Gaya","Hajipur","Jamalpur","Katihar","Madhubani","Munger","Muzaffarpur","Patna","Purnia","Rohtas","Saharsa","Samastipur","Sasaram","Sitamarhi","Siwan","Supaul","Vaishali","West Champaran"],
            "Chandigarh": ["Amritsar","Barnala","Bathinda","Chandigarh","Firozpur","Faridkot","Fatehgarh Sahib","Ferozepur","Gurdaspur","Hoshiarpur","Jalandhar","Kapurthala","Ludhiana","Mansa","Moga","Muktsar","Nawanshahr","Pathankot","Patiala","Rupnagar","Sangrur","Shahid Bhagat Singh Nagar","Sri Muktsar Sahib","Tarn Taran","Zirakpur"],
            "Chhattisgarh": ["Bhilai", "Bilaspur","Durg" ,"Korba","Mahasamund","Raigarh","Raipur","Rajnandgaon","Surajpur","Surguja","Udaipur"],
            "Dadra and Nagar Haveli and Daman and Diu": ["Daman", "Diu", "Silvassa"],
            "Delhi": ["Delhi","New Delhi","Noida"],
            "Goa": [ "Bagaha","Mapusa","Margao","Panaji","Vasco da Gama" ],
            "Gujarat": ["Ahmedabad", "Amreli", "Anand", "Aravalli", "Banaskantha", "Bharuch", "Bhavnagar", "Botad", "Chhota Udaipur", "Dahod", "Dang", "Devbhoomi Dwarka", "Gandhinagar", "Gir Somnath", "Gurugram", "Jamnagar", "Junagadh", "Kheda", "Kutch", "Mahisagar", "Mehsana", "Morbi", "Narmada", "Navsari", "Panchmahal", "Patan", "Porbandar", "Rajkot", "Sabarkantha", "Surat", "Surendranagar", "Tapi", "Vadodara", "Valsad", "Vapi"],
            "Haryana": [ "Ambala", "Bahadurgarh","Faridabad", "Fatehabad", "Gohana", "Gurgaon", "Hisar", "Jhajjar", "Jind", "Kaithal", "Karnal", "Kurukshetra", "Mahendragarh", "Nuh", "Palwal", "Panchkula", "Panipat", "Rewari", "Rohtak", "Sirsa", "Sonipat", "Yamuna Nagar", "Yamunanagar"],
            "Himachal Pradesh": ["Bilaspur", "Chamba", "Dalhousie","Dharamshala", "Hamirpur", "Kangra", "Kinnaur", "Kullu", "Lahaul and Spiti", "Mandi", "Sirmaur",  "Shimla", "Solan", "Una"],
            "Jammu and Kashmir": ["Anantnag", "Bandipora", "Baramulla", "Budgam", "Doda", "Ganderbal", "Jammu", "Kathua", "Kishtwar", "Kulgam", "Kupwara", "Mirpur", "Nahan", "Reasi", "Samba", "Shopiyan", "Sopore", "Srinagar", "Udhampur"],
            "Jharkhand": ["Bokaro","Chaibasa", "Deoghar","Dhanbad","Giridih","Hazaribag","Jamshedpur","Khunti","Lohardaga","Patratu","Ramgarh",,"Ranchi","Simdega","West Singhbhum","East Singhbhum","Yamuna Nagar"],
            "Karnataka": ["Bengaluru", "Belgaum", "Bellary", "Bidar", "Bijapur", "Chamarajnagar", "Chikkaballapur", "Chikkamagaluru", "Chitradurga", "Dakshina Kannada", "Davanagere", "Dharwad", "Gadag", "Gulbarga", "Hassan", "Haveri","Hubballi", "Kodagu", "Kolar", "Koppal", "Mandya", "Mysuru", "Mangaluru", "Raichur", "Ramanagara", "Shivamogga", "Tumakuru", "Udupi", "Uttara Kannada", "Vijayapura"],
            "Kerala": ["Kochi", "Kozhikode", "Malappuram", "Palakkad", "Thiruvananthapuram",  "Thrissur", "Wayanad"],
            "Ladakh": ["Kargil", "Leh" ],
            "Lakshadweep": ["Agatti","Kavaratti","Mokokchung",  "Minicoy"],
            "Madhya Pradesh": ["Bhopal", "Burhanpur", "Chhatarpur", "Chhindwara", "Damoh", "Datia", "Dewas", "Dhar", "Guna", "Gwalior", "Harda", "Hoshangabad", "Indore",  "Jabalpur", "Jagdalpur", "Jhabua", "Katni", "Khandwa", "Khargone", "Mandla", "Mandsaur", "Morena", "Narsinghpur", "Neemuch", "Niwari", "Panna", "Raisen", "Rajgarh", "Ratlam", "Rewa", "Sagar", "Satna", "Sehore", "Seoni", "Shahdol", "Shajapur", "Sheopur", "Shivpuri", "Sidhi", "Tikamgarh", "Ujjain", "Umaria", "Vidisha"],
            "Maharashtra": [ "Ahmednagar", "Aurangabad", "Beed", "Bhandara", "Buldhana", "Chandrapur", "Dhule", "Gadchiroli", "Gondia", "Hingoli", "Jalgaon", "Jalna", "Kolhapur", "Latur", "Mumbai Suburban","Mumbai",  "Nagpur", "Nanded", "Nandurbar", "Nashik", "Osmanabad", "Parbhani", "Pune", "Raigad", "Ratnagiri", "Sangli", "Satara", "Sholapur", "Sindhudurg", "Thane", "Wardha", "Washim", "Yavatma", "Yawal"],
            "Manipur": ["Imphal", "Thoubal", "Bishnupur"],
            "Meghalaya": ["Shillong", "Tura", "Jowai"],
            "Mizoram": ["Aizawl", "Lunglei", "Saiha"],
            "Nagaland": ["Kohima", "Dimapur", "Mokokchung"],
            "Odisha": ["Bhubaneswar", "Cuttack", "Rourkela", "Puri"],
            "Puducherry": ["Puducherry", "Karaikal", "Mahe", "Yanam"],
            "Punjab": [ "Ajitgarh","Amritsar", "Barnala", "Bathinda", "Firozpur", "Faridkot", "Fatehgarh Sahib", "Fazilka", "Gurdaspur", "Hoshiarpur", "Jagraon","Jalandhar", "Kapurthala", "Ludhiana", "Mansa", "Moga", "Muktsar", "Nawanshahr", "Pathankot", "Patiala", "Rupnagar", "Sangrur", "Shahid Bhagat Singh Nagar", "Sohna","Sri Muktsar Sahib", "Tarn Taran", "Zirakpur"],
            "Rajasthan": ["Ajmer", "Bikaner", "Bhilwara", "Jaipur", "Jaisalmer", "Jodhpur", "Kota", "Udaipur"],
            "Sikkim": ["Gangtok", "Mangan", "Namchi"],
            "Tamil Nadu": ["Chennai", "Coimbatore", "Cuddalore", "Dindigul", "Erode", "Kanyakumari", "Kodaikanal", "Madurai", "Ramanathapuram", "Salem", "Thanjavur", "Tiruchirappalli", "Tirunelveli", "Vellore", "Viluppuram", "Virudhunagar"],
            "Telangana": ["Hyderabad", "Karimnagar", "Mahbubnagar", "Nalgonda", "Nizamabad", "Rangareddy", "Warangal"],
            "Tripura": ["Agartala", "Dharmanagar", "Nagaon", "Udaipur"],
            "Uttar Pradesh": ["Agra", "Allahabad", "Aligarh", "Ambedkar Nagar", "Amethi", "Amroha", "Auraiya", "Azamgarh", "Baghpat", "Bahraich", "Ballia", "Balrampur", "Banda", "Barabanki", "Bareilly", "Basti", "Bhadohi", "Bijnor", "Budaun", "Bulandshahr", "Chandauli", "Chitrakoot", "Deoria", "Etah", "Etawah", "Faizabad", "Farrukhabad", "Fatehpur", "Firozabad", "Gautam Buddha Nagar", "Ghaziabad", "Ghazipur", "Gonda", "Gorakhpur", "Hamirpur", "Hapur", "Hardoi", "Hathras", "Jalaun", "Jaunpur", "Jhansi", "Kannauj", "Kashipur",  "Kaushambi", "Kushinagar", "Lakhimpur Kheri", "Lalitpur", "Lucknow", "Maharajganj", "Mahoba", "Mainpuri", "Mathura", "Mau", "Meerut", "Mirzapur", "Moradabad", "Muzaffarnagar", "Pilibhit", "Pratapgarh", "Prayagraj", "Raebareli", "Rampur", "Saharanpur", "Sambhal", "Sant Kabir Nagar", "Shahjahanpur", "Shamli", "Shravasti", "Siddharthnagar", "Sitapur", "Sonbhadra", "Sultanpur", "Unnao", "Kanpur","Lucknow", "Varanasi"],
            "Uttarakhand": [ "Almora","Dehradun", "Haldwani", "Haridwar", "Nainital", "Roorkee", "Rishikesh", "Rudrapur", "Uttarkashi"],
            "West Bengal": [ "Asansol","Durgapur", "Kolkata","Siliguri" ]
        };
        const stateSelect = document.getElementById('estate');
        const citySelect = document.getElementById('ecity');
        for (const state in statesAndCities) {
              const option = document.createElement('option');
              option.value = state;
              option.textContent = state;
              stateSelect.appendChild(option);
        }
        stateSelect.addEventListener('change', (event) => {
            const selectedState = event.target.value;
            const cities = statesAndCities[selectedState] || [];
            citySelect.innerHTML = '<option selected disabled>Choose Your City</option>';
            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });
        });
    });
    </script>
</body>
</html>
